#!/bin/bash
# Copyright (c) 2021 Oracle and/or its affiliates.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.

# Make sure this is run via source or .
if ! (return 0 2>/dev/null); then
  echo "ERROR: Usage 'source destroy.env'"
  return 1
fi

# This script must be run with DCMS code in the current directory
if ! test -d microservices-datadriven; then
  echo "ERROR: This script must be run with the microservices-datadriven code in the current directory"
  return 1
fi

export MSDD_CODE_HOME=$PWD/microservices-datadriven

DCMS_WORKSHOP_HOME=$PWD/dcmsrun
mkdir -p $DCMS_WORKSHOP_HOME

DCMS_WORKSHOP_LOG=$DCMS_WORKSHOP_HOME/log
mkdir -p $DCMS_WORKSHOP_LOG


# Execute the setup
SETUP_SCRIPT="$MSDD_CODE_HOME/workshop/dcms-oci/destroy.sh"
$SETUP_SCRIPT $DCMS_WORKSHOP_HOME 2>&1 | tee -ai $DCMS_WORKSHOP_LOG/destroy.log

