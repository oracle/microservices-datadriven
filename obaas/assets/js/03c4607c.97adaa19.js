"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[469],{1254:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>c,toc:()=>a});const c=JSON.parse('{"id":"platform/coherence","title":"Coherence Operator","description":"Coherence Operator","source":"@site/docs/platform/coherence.md","sourceDirName":"platform","slug":"/platform/coherence","permalink":"/microservices-datadriven/obaas/docs/platform/coherence","draft":false,"unlisted":false,"editUrl":"https://github.com/oracle/microservices-datadriven/tree/main/docs-source/site/docs/platform/coherence.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Coherence Operator","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Apache Kafka","permalink":"/microservices-datadriven/obaas/docs/platform/apachekafka"},"next":{"title":"Conductor Workflow Orchestration","permalink":"/microservices-datadriven/obaas/docs/platform/conductor"}}');var t=r(4848),o=r(8453);const s={title:"Coherence Operator",sidebar_position:3},i=void 0,l={},a=[{value:"Coherence Operator",id:"coherence-operator",level:2},{value:"Installing the Coherence Operator",id:"installing-the-coherence-operator",level:3},{value:"Creating a Coherence Cluster",id:"creating-a-coherence-cluster",level:3},{value:"Prerequisites",id:"prerequisites",level:4},{value:"Step 1: Create the Coherence Cluster YAML",id:"step-1-create-the-coherence-cluster-yaml",level:5},{value:"YAML Configuration Files",id:"yaml-configuration-files",level:5},{value:"Step 2: Deploy the Cluster",id:"step-2-deploy-the-cluster",level:5},{value:"Step 3: Verify the Deployment",id:"step-3-verify-the-deployment",level:5},{value:"Using Coherence with Spring Boot",id:"using-coherence-with-spring-boot",level:3},{value:"Dependencies",id:"dependencies",level:4},{value:"Spring Boot Configuration",id:"spring-boot-configuration",level:4}];function h(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"coherence-operator",children:"Coherence Operator"}),"\n",(0,t.jsxs)(n.p,{children:["The Oracle Coherence Operator is an open-source Kubernetes operator that enables the deployment and management of Oracle Coherence clusters in Kubernetes environments. It provides features to assist with deploying, scaling, and managing Coherence data grid clusters using cloud-native technologies. ",(0,t.jsx)(n.a,{href:"https://oracle.github.io/coherence-operator/",children:"Full Documentation can be found here"})]}),"\n",(0,t.jsx)(n.h3,{id:"installing-the-coherence-operator",children:"Installing the Coherence Operator"}),"\n",(0,t.jsxs)(n.p,{children:["Oracle Database Operator for Kubernetes will be installed if the ",(0,t.jsx)(n.code,{children:"coherence.enabled"})," is set to ",(0,t.jsx)(n.code,{children:"true"})," in the ",(0,t.jsx)(n.code,{children:"values.yaml"})," file. The default namespace for Oracle Database Operator is ",(0,t.jsx)(n.code,{children:"coherence"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"creating-a-coherence-cluster",children:"Creating a Coherence Cluster"}),"\n",(0,t.jsxs)(n.p,{children:["Follow these steps to create a basic Coherence cluster named ",(0,t.jsx)(n.code,{children:"mysample-cluster"}),":"]}),"\n",(0,t.jsx)(n.h4,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Coherence Operator is installed and running"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"kubectl"})," is configured to access your Kubernetes cluster"]}),"\n",(0,t.jsxs)(n.li,{children:["You have a namespace where you want to deploy the cluster (e.g., ",(0,t.jsx)(n.code,{children:"coherence"}),")"]}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"step-1-create-the-coherence-cluster-yaml",children:"Step 1: Create the Coherence Cluster YAML"}),"\n",(0,t.jsxs)(n.p,{children:["Create a file named ",(0,t.jsx)(n.code,{children:"mysample-cluster.yaml"})," with the basic cluster configuration"]}),"\n",(0,t.jsx)(n.h5,{id:"yaml-configuration-files",children:"YAML Configuration Files"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Basic Cluster Configuration"})," (",(0,t.jsx)(n.code,{children:"mysample-cluster.yaml"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"apiVersion: coherence.oracle.com/v1\nkind: Coherence\nmetadata:\n  name: mysample-cluster\nspec:\n  replicas: 3\n  image: ghcr.io/oracle/coherence-ce:22.06.7\n  coherence:\n    cacheConfig: coherence-cache-config.xml\n  jvm:\n    memory:\n      heapSize: 2g\n  ports:\n    - name: http\n      port: 8080\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Cluster with Persistence"})," (",(0,t.jsx)(n.code,{children:"mysample-cluster-persistent.yaml"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: coherence.oracle.com/v1\nkind: Coherence\nmetadata:\n  name: mysample-cluster\nspec:\n  replicas: 3\n  image: ghcr.io/oracle/coherence-ce:22.06.7\n  coherence:\n    cacheConfig: coherence-cache-config.xml\n    persistence:\n      mode: active\n      persistentVolumeClaim:\n        accessModes:\n          - ReadWriteOnce\n        resources:\n          requests:\n            storage: 10Gi\n  jvm:\n    memory:\n      heapSize: 2g\n  ports:\n    - name: http\n      port: 8080\n    - name: metrics\n      port: 9612\n  env:\n    - name: OTEL_EXPORTER_OTLP_ENDPOINT\n      value: "http://otel-collector:4317"\n    - name: OTEL_SERVICE_NAME\n      value: "mysample-cluster"\n    - name: OTEL_METRICS_EXPORTER\n      value: "otlp"\n    - name: OTEL_TRACES_EXPORTER\n      value: "otlp"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"replicas"})," field determines the number of pods in the cluster (default: 3)"]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"image"})," field specifies the Coherence container image to use"]}),"\n",(0,t.jsxs)(n.li,{children:["For persistence, ensure your Kubernetes cluster has a default StorageClass configured, or specify one using ",(0,t.jsx)(n.code,{children:"storageClassName"})]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"env"})," section configures OpenTelemetry (OTEL) for metrics and traces export to an OTEL collector"]}),"\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"metrics"})," port (9612) exposes Coherence metrics for collection"]}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"step-2-deploy-the-cluster",children:"Step 2: Deploy the Cluster"}),"\n",(0,t.jsx)(n.p,{children:"Apply the YAML configuration to create the cluster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f mysample-cluster.yaml -n coherence\n"})}),"\n",(0,t.jsx)(n.h5,{id:"step-3-verify-the-deployment",children:"Step 3: Verify the Deployment"}),"\n",(0,t.jsx)(n.p,{children:"Check that the cluster pods are running:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Check the Coherence resource\nkubectl get coherence -n coherence\n\n# Check the pods\nkubectl get pods -n coherence\n\n# View cluster details\nkubectl describe coherence mysample-cluster -n coherence\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Wait for all pods to reach the ",(0,t.jsx)(n.code,{children:"Running"})," state. You can watch the progress with:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n coherence -w\n"})}),"\n",(0,t.jsx)(n.h3,{id:"using-coherence-with-spring-boot",children:"Using Coherence with Spring Boot"}),"\n",(0,t.jsxs)(n.p,{children:["To connect your Spring Boot application to the ",(0,t.jsx)(n.code,{children:"mysample-cluster"})," Coherence cluster deployed above, you need to add the following dependencies and configuration. ",(0,t.jsx)(n.a,{href:"https://spring.coherence.community/4.3.0/index.html#/about/01_overview",children:"Coherence Spring Documentation"})]}),"\n",(0,t.jsx)(n.h4,{id:"dependencies",children:"Dependencies"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Maven"})," (",(0,t.jsx)(n.code,{children:"pom.xml"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n    \x3c!-- Coherence Spring Boot Starter --\x3e\n    <dependency>\n        <groupId>com.oracle.coherence.spring</groupId>\n        <artifactId>coherence-spring-boot-starter</artifactId>\n    </dependency>\n\n    \x3c!-- Coherence CE --\x3e\n    <dependency>\n        <groupId>com.oracle.coherence.ce</groupId>\n        <artifactId>coherence</artifactId>\n    </dependency>\n</dependencies>\n"})}),"\n",(0,t.jsx)(n.h4,{id:"spring-boot-configuration",children:"Spring Boot Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Create or update your ",(0,t.jsx)(n.code,{children:"application.yaml"})," file to connect to the ",(0,t.jsx)(n.code,{children:"mysample-cluster"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"coherence:\n  # Set the instance type to 'client' to connect to an existing cluster\n  instance:\n    type: client\n\n  # Configure the cluster connection\n  cluster:\n    name: mysample-cluster\n\n  # Configure sessions\n  sessions:\n    - name: default\n      config: coherence-cache-config.xml\n      priority: 1\n\n  # Logging configuration (optional)\n  logging:\n    destination: slf4j\n    logger-name: Coherence\n\n  # Server startup timeout (optional)\n  server:\n    startup-timeout: 60s\n"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>i});var c=r(6540);const t={},o=c.createContext(t);function s(e){const n=c.useContext(o);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),c.createElement(o.Provider,{value:n},e.children)}}}]);